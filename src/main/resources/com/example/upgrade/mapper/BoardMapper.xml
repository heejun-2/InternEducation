<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.example.upgrade.mapper.BoardMapper">

    <select id="getBoardList" resultType="com.example.upgrade.entity.Board" parameterType="com.example.upgrade.dto.BoardSch">
        SELECT *
        FROM board
        WHERE title LIKE CONCAT('%',#{title},'%')
        ORDER BY boardId DESC
        LIMIT #{rowCount}
        OFFSET #{offset};
    </select>

    <select id="getBoard" resultType="com.example.upgrade.entity.Board" parameterType="int">
        SELECT *
        FROM board
        WHERE boardId = #{boardId};
    </select>

    <select id="countBoard" resultType="int">
        SELECT count(boardId) AS cnt
        FROM board;
    </select>

    <select id="titleCount" resultType="int" parameterType="com.example.upgrade.dto.BoardSch">
        SELECT count(boardId) AS cnt
        FROM board
        WHERE title LIKE CONCAT('%',#{title},'%')
    </select>

    <update id="plusVisitCount" parameterType="int">
        UPDATE board
        SET visitCount = visitCount + 1
        WHERE boardId = #{boardId};
    </update>

    <insert id="create" parameterType="com.example.upgrade.entity.Board">
        INSERT INTO board(title, content, name, visitCount, memberId, uploadFileName, storeFileName) VALUES (#{title}, #{content}, #{name}, #{visitCount}, #{memberId}, #{uploadFileName}, #{storeFileName});
    </insert>

    <update id="update" parameterType="com.example.upgrade.entity.Board">
        UPDATE board
        SET title = #{title},
            content = #{content},
            uploadFileName = #{uploadFileName},
            storeFileName = #{storeFileName}
        WHERE boardId = #{boardId};
    </update>

    <delete id="delete" parameterType="int">
        DELETE board
        WHERE boardId = #{boardId};
    </delete>



    <delete id="deleteAll">
        DELETE FROM board;
    </delete>

    <update id="fileDelete" parameterType="int">
        UPDATE board
        SET uploadFileName = '',
            storeFileName = ''
        WHERE boardId = #{boardId};
    </update>
</mapper>